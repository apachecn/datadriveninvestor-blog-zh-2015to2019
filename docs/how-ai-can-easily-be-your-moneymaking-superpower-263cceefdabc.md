# äººå·¥æ™ºèƒ½å¦‚ä½•è½»æ¾æˆä¸ºä½ èµšé’±çš„è¶…èƒ½åŠ›

> åŸæ–‡ï¼š<https://medium.datadriveninvestor.com/how-ai-can-easily-be-your-moneymaking-superpower-263cceefdabc?source=collection_archive---------6----------------------->

[![](img/ff548bf64d7807fcfadcf8fe6f2a539f.png)](http://www.track.datadriveninvestor.com/1B9E)

## ç”¨é€’å½’ç¥ç»ç½‘ç»œå’Œ LSTMs é¢„æµ‹è‚¡ç¥¨

![](img/07332a23d993f7a39a55f3fb355cd71f.png)

Photo by [Franki Chamaki](https://unsplash.com/@franki?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

å¦‚æœä½ èƒ½æ‹¥æœ‰ä»»ä½•å®é™…çš„è¶…èƒ½åŠ›ï¼Œé‚£ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ

å¯¹äºè®¸å¤šäººæ¥è¯´ï¼Œä»–ä»¬ä¼šè¯´é¢„æµ‹æœªæ¥æˆ–è½»æ¾èµšé’±çš„èƒ½åŠ›(ç¬¬*å’Œä¸ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¿«é€Ÿèµšé’±çš„éª—å±€*)ã€‚

å¥½å§ï¼Œä½ å¯ä»¥åœ¨ä½ çš„â€œäººå·¥æ™ºèƒ½å·²ç»å®Œæˆçš„ç–¯ç‹‚äº‹æƒ…æ¸…å•â€ä¸Šæ·»åŠ å¦ä¸€ä¸ªé¡¹ç›®ï¼Œå› ä¸ºäººå·¥æ™ºèƒ½ç¡®å®å¯ä»¥åšåˆ°è¿™ä¸¤è€…ã€‚

å¤´è„‘ B L O W NğŸ¤¯

äººå·¥æ™ºèƒ½*å®é™…ä¸Šæ˜¯*èƒ½å¤Ÿé¢„æµ‹æœªæ¥è‚¡ç¥¨ä»·æ ¼çš„æ³¢åŠ¨ã€‚è¿™ä¹Ÿä¸éš¾åšåˆ°ã€‚

![](img/b2a5ef822952b6df7b039528a5f3e98a.png)

The model I builtâ€™s prediction in comparison to actual prices.

è¿™ç§ç±»å‹çš„äººå·¥æ™ºèƒ½å°†è¢«å½’ç±»ä¸ºä½¿ç”¨*æ·±åº¦å­¦ä¹ *ã€‚æ·±åº¦å­¦ä¹ æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­éƒ¨åˆ†ï¼Œå…¶å·¥ä½œæ–¹å¼ç±»ä¼¼äº**äººè„‘å­¦ä¹ **çš„æ–¹å¼ã€‚ä¸åŒç±»å‹çš„äººå·¥ç¥ç»ç½‘ç»œæ­£è¢«ç”¨æ¥æ¨¡æ‹Ÿäººç±»å¤§è„‘çš„éƒ¨åˆ†ï¼Œå¹¶åˆ›é€ å‡ºæ›´å¼ºå¤§çš„äººå·¥æ™ºèƒ½ã€‚å¦‚æœä½ éœ€è¦æ·±åº¦å­¦ä¹ çš„å¤ä¹ ï¼Œä½ å¯ä»¥çœ‹çœ‹æˆ‘çš„æ–‡ç« [è¦†ç›–åŸºæœ¬æ¦‚å¿µï¼](https://medium.com/@mishaallakhani/machines-with-brains-like-ours-an-intro-to-deep-learning-a5dff4c24e97)

![](img/8326376fb6c3e0fa8698136d90fd1d52.png)

æ‰€ä»¥ï¼Œä¸ºäº†**ç†è§£æ·±åº¦å­¦ä¹ **ï¼Œå¹¶æ·±å…¥åˆ°è‚¡ç¥¨é¢„æµ‹å™¨çš„æ¨¡å‹ç±»å‹(*é€’å½’ç¥ç»ç½‘ç»œ*)ï¼Œåªæœ‰æé†’æˆ‘ä»¬è‡ªå·±**æˆ‘ä»¬è‡ªå·±çš„å¤§è„‘æ˜¯å¦‚ä½•å·¥ä½œçš„**æ‰æœ‰æ„ä¹‰ã€‚

å¦‚æœä½ ç¢°å·§æ˜¯ä¸€ä¸ªå¤§è„‘äº’åŠ¨ä½“ï¼Œå¹¶æƒ³è·³è¿‡è¿™ä¸ªå¤ä¹ ï¼Œä½ å¯ä»¥ç‚¹å‡»[è¿™é‡Œ](https://medium.com/p/263cceefdabc#d67a)è·³è½¬åˆ° rnn çš„ç±»å‹ã€‚

å¯¹äºé‚£äº›éœ€è¦å”¤èµ·ä»–ä»¬å¯¹å…­å¹´çº§å¥åº·è¯¾è®°å¿†çš„äººï¼Œè®©æˆ‘å¸¦ä½ è¿›å…¥æˆ‘ä»¬çš„å¤§è„‘ã€‚

å¤§è„‘æœ‰ 3 ä¸ªä¸»è¦éƒ¨åˆ†:å¤§è„‘ ***(æ·±åº¦å­¦ä¹ å…³æ³¨çš„)*** ã€*å°è„‘*ã€*è„‘å¹²*ã€‚

å¤§è„‘è¢«åˆ†è§£æˆ**é¢å¶**ã€**é¢å¶**ã€**æ•å¶**å’Œé¡¶å¶ï¼Œé€šè¿‡ä¸åŒç±»å‹çš„äººå·¥ç¥ç»ç½‘ç»œè¿›è¡Œæ¨¡æ‹Ÿã€‚

![](img/2c16d9bfdd902fc6029514cef425ea66.png)

Deep learning is can relate to the way certain lobes in the cerebrum function.

*   é¢å¶:æ¥æ”¶æ„Ÿè§‰ä¿¡æ¯ï¼Œå¤„ç†ä¿¡æ¯ï¼Œé€šè¿‡å…ˆå‰çš„ç»éªŒ(é•¿æœŸè®°å¿†)è¿›è¡Œå­¦ä¹  **â€”äººå·¥ç¥ç»ç½‘ç»œ**
*   æ•å¶:è§†è§‰å¤„ç†ï¼ŒåŸºæœ¬ä¸Šæ˜¯å›¾åƒè¯†åˆ« **â€”å·ç§¯ç¥ç»ç½‘ç»œ**
*   é¢å¶:çŸ­æœŸè®°å¿†ï¼Œè®°ä½ä»¥å‰è§‚å¯Ÿåˆ°çš„ä¿¡æ¯å¹¶å°†å…¶åº”ç”¨äºå‰æ–¹**â€”â€”å¾ªç¯ç¥ç»ç½‘ç»œ**

![](img/38336204b414d2ff5b2d945cb26725f5.png)

Why make our most powerful tech without a short term memory?

å¯¹äºå¾ˆå¤šæƒ…å†µï¼Œ*æ²¡æœ‰æ„ä¹‰* ***æ²¡æœ‰*** ç»™äºˆè¿™äº›å¼ºå¤§çš„ç¨‹åºè¿™ç§å¥¢ä¾ˆã€‚ä»¥é˜…è¯»è¿™ç¯‡æ–‡ç« ä¸ºä¾‹ã€‚å¦‚æœä½ çœŸçš„è®°ä¸èµ·ä½ è¯»è¿‡çš„å‰ä¸€å¥è¯ï¼Œé‚£å°±å¤ªå¯æ‚²äº†ã€‚

é€’å½’ç¥ç»ç½‘ç»œå…·æœ‰åˆ©ç”¨å…·æœ‰çŸ­æœŸè®°å¿†çš„ç¥ç»å…ƒçš„èƒ½åŠ›ã€‚**åŸºæœ¬ä¸Šï¼Œå®ƒä»¬å¯ä»¥è®°ä½ä¹‹å‰ç¥ç»å…ƒä¸­çš„å†…å®¹ï¼Œå¹¶åœ¨ç½‘ç»œå†…ä¼ é€’ç»™æœªæ¥çš„ç¥ç»å…ƒ**ã€‚

> â€œè¿™å¾ˆé‡è¦ï¼Œå› ä¸ºæ•°æ®åºåˆ—åŒ…å«äº†å…³äºæ¥ä¸‹æ¥ä¼šå‘ç”Ÿä»€ä¹ˆçš„å…³é”®ä¿¡æ¯ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆ RNN å¯ä»¥åšå…¶ä»–ç®—æ³•ä¸èƒ½åšçš„äº‹æƒ…ã€‚â€[å°¼å…‹æ‹‰æ–¯Â·ä¸œæ ¼æ–¯](https://towardsdatascience.com/@n.donges)

# ä¸è¿‡ï¼ŒRNNs å¹¶ä¸æ˜¯ä¸‡èƒ½çš„ã€‚æœ‰å‡ ç§ä¸åŒçš„ç±»å‹:

## 1.ä¸€å¯¹å¤š(ä¸€ä¸ªè¾“å…¥å’Œå¤šä¸ªè¾“å‡º)

![](img/c8f40cc89c3cc8a721a32b4a576085e5.png)

One Input (yellow) leads to multiple outputs (red)

æœ‰äº†ä¸€ä¸ªè¾“å…¥ï¼Œæ¯”å¦‚ä¸€å¼ å›¾ç‰‡ï¼Œç½‘ç»œå°±ä¼šäº§ç”Ÿä¸€ä¸ªæœ‰å¤šä¸ªå•è¯çš„è¿è´¯å¥å­ä½œä¸ºè¾“å‡ºã€‚RNN èƒ½å¤Ÿåˆ›é€ å‡ºä¸€ä¸ªæœ‰æ„ä¹‰çš„å¥å­ï¼Œå› ä¸ºå®ƒèƒ½å°†å¥å­ä¸­çš„ä¸‹ä¸€ä¸ªå•è¯å»ºç«‹åœ¨å‰é¢çš„å•è¯çš„åŸºç¡€ä¸Šã€‚

## 2.å¤šå¯¹ä¸€(å¤šä¸ªè¾“å…¥å’Œä¸€ä¸ªè¾“å‡º)

![](img/5a84b7d713759a5eab27c96bdeb2afd5.png)

The multiple inputs (yellow) leads to one output (red)

ç±»ä¼¼æƒ…æ„Ÿåˆ†æå™¨çš„ä¸œè¥¿å°±æ˜¯å¤šå¯¹ä¸€ RNN çš„ä¸€ä¸ªä¾‹å­ã€‚é€šè¿‡ä¸²åœ¨ä¸€èµ·çš„å¤šä¸ªå•è¯/å€¼çš„**è¾“å…¥å’Œå¯¹å•è¯å«ä¹‰çš„ç†è§£ï¼Œç½‘ç»œ**åˆ†ç±»æˆ–ç»™å‡ºå•ä¸ªè¾“å‡º**ã€‚**

## 3.å¤šå¯¹å¤š

![](img/8af20247c1f9e9da1694b0f096bec914.png)

Multiple outputs(yellow) leads to multiple outputs(red)

æƒ³æƒ³ä¸€ä¸ªç¿»è¯‘å™¨ï¼Œæœ‰**å¤šä¸ªè¾“å…¥**(ä¸€äº›æ–‡æœ¬)ï¼Œå¯¼è‡´**å¤šä¸ªè¾“å‡º**(å¦ä¸€ç»„æ–‡æœ¬)ã€‚ä½ éœ€è¦å…³äºå‰é¢å•è¯çš„çŸ­æœŸä¿¡æ¯æ¥ç¿»è¯‘ä¸‹ä¸€ä¸ªå•è¯ã€‚

# ä½†æ˜¯æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ

è¿™å¬èµ·æ¥ä¸é”™ï¼Œå¦‚æœä½ é—®æˆ‘çš„è¯ï¼Œæœ‰ç‚¹å¤ªå¥½äº†ã€‚å½“ç„¶ï¼Œè¿™å…¶ä¸­è‚¯å®šæœ‰çŒ«è…»ã€‚

ä½ å¯ä»¥è¯´å¯¹äº RNNs æ¥è¯´ï¼Œæˆ‘ä»¬çš„é—®é¢˜ä¸æ˜¯*æ˜¯ä»€ä¹ˆ*ï¼Œè€Œæ˜¯å®ƒçš„*ä¸æ˜¯ä»€ä¹ˆâ€”* åˆåæ¶ˆå¤±æ¸å˜

*å™—* *ä¸€ä¸ª*ä¸€ä¸ª*çš„æ¸å˜æ¶ˆå¤±å¾—æ— å½±æ— è¸ª*ğŸ©

å¥½å§ï¼Œä¸å®Œå…¨æ˜¯ã€‚

***æ¶ˆå¤±æ¢¯åº¦*** æ˜¯å½“åœ¨**é•¿åºåˆ—**ä¸­ï¼Œæ¢¯åº¦æœ€ç»ˆ**éå¸¸ä½â€”â€”**å¯¼è‡´**ç»“æœ**ä¸å‡†ç¡®ï¼ŒçœŸæ­£**è®­ç»ƒæ—¶é—´**ã€‚

***æ¢¯åº¦*** æ˜¯**æˆæœ¬ç›¸å¯¹äºæƒé‡æˆ–åå·®å˜åŒ–**çš„æ¯”ç‡ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä»»ä½•ä¸€ç‚¹çš„æ¢¯åº¦éƒ½æ˜¯ä¹‹å‰æ¢¯åº¦çš„**ä¹˜ç§¯ã€‚**

*(ç½‘ç»œ*é¢„æµ‹*è¾“å‡ºå’Œ*å®é™…*è¾“å‡ºä¹‹é—´çš„*å·®*æ¥è‡ªæ ‡è®°çš„è®­ç»ƒæ•°æ®)é€šè¿‡åå¤è®­ç»ƒè°ƒæ•´æƒé‡å’Œåå·®æ¥é™ä½ï¼Œç›´åˆ°è·å¾—æœ€ä½å€¼ã€‚*

*åœ¨ RNN ä¸­ï¼Œè¿æ¥å’Œ**éšè—å±‚**çš„ ***é€’å½’æƒé‡*** åœ¨æ—¶é—´**å¾ªç¯**ä¸­ç»“æŸâ€”â€”è¿™äº›å°æƒé‡è¢«ä¸€æ¬¡åˆä¸€æ¬¡åœ°ç›¸ä¹˜ï¼Œå¯¼è‡´å°å€¼å˜å¾—æ›´å°ã€‚*

*ä½ ç©¿è¿‡ç½‘ç»œçš„**æ›´è¿œçš„**ï¼Œè®­ç»ƒé‡é‡çš„**æ›´ä½çš„****å¡åº¦**å’Œ**æ›´éš¾çš„**ï¼Œè¿™å¯¹æ•´ä¸ªç½‘ç»œä¸­çš„æ‰€æœ‰æ›´è¿œçš„é‡é‡äº§ç”Ÿäº†**å¤šç±³è¯ºéª¨ç‰Œæ•ˆåº”**ã€‚åŸºæœ¬ä¸Šï¼Œè¿™äº›æ—©æœŸå±‚è´Ÿè´£æˆä¸ºç®€å•çš„æ„å»ºå—ã€‚å¦‚æœæ—©æœŸçš„å±‚å‡ºé”™äº†ï¼Œé‚£ä¹ˆæ ¹æ®å®ƒä»¬çš„è¾“å‡ºæ„å»ºçš„åç»­å±‚ä¹Ÿä¼šå‡ºé”™ã€‚*

# *è§£å†³åŠæ³•ï¼Ÿé•¿çŸ­æœŸè®°å¿†*

*æœ‰äº†æ¶ˆå¤±æ¢¯åº¦çš„é—®é¢˜ï¼Œå¾ªç¯æƒé‡å°äº 1ï¼Œæ‰€ä»¥åŸºæœ¬ä¸Šå°±æ¶ˆå¤±äº†ã€‚ ***é•¿çŸ­æœŸå¤‡å¿˜å½•* ry** çš„ç›®æ ‡æ˜¯ä½¿**æƒé‡ç­‰äº 1**å¹¶ä¸”**æ ¹æ® RNN**å®é™…éœ€è¦çŸ¥é“çš„**æ¥è¿‡æ»¤è¾“å…¥**ä»¥ç”¨äºä¸‹ä¸€ä¸ªè¾“å‡ºã€‚*

*![](img/f722413ab1482a1e2389c46eb81b43b4.png)*

*A really really really simplified LSTM cell*

*LSTM å•å…ƒæœ‰ **4 ä¸ªé—¨**æ¥ç®¡ç†å…ˆå‰å’Œæ–°çš„è¾“å…¥ï¼Œä»¥ç¡®å®šè¾“å‡ºã€‚é€‰æ‹©**å¿˜è®°**ã€**å­¦ä¹ **ã€**è®°ä½**è¿˜æ˜¯**ä½¿ç”¨**æŸäº›è¾“å…¥å†³å®šæ˜¯å¦éœ€è¦å½±å“è¾“å‡ºå€¼ã€‚*

*ä»¥é¢„æµ‹è‚¡ç¥¨ä»·æ ¼ä¸ºä¾‹ã€‚å¯¹æ–°è‚¡ç¥¨ä»·æ ¼çš„é¢„æµ‹å–å†³äº:*

1.  *å‰å‡ å¤©çš„ä¸Šæ¶¨æˆ–ä¸‹è·Œè¶‹åŠ¿â†’ **å‰å‡ ä¸ªå•å…ƒæ ¼çŠ¶æ€***
2.  *å‰å‡ å¤©çš„è‚¡ç¥¨ä»·æ ¼(çŸ­æœŸ)â†’ **å‰ä¸€ä¸ªå•å…ƒæ ¼çš„è¾“å‡º***
3.  *å…¶ä»–å¯èƒ½å½±å“å…¬ä¼—æ„è§çš„å› ç´ â€”â€”æ–°çš„å…¬å¸æ”¿ç­–ã€åˆ©æ¶¦ä¸‹é™ç­‰ã€‚â†’ **å½“å‰æ—¶é—´çš„è¾“å‡º***

*LSTM è¯†åˆ«è¿™ä¸€ç‚¹å¹¶ä¼ é€’ç›¸å…³ä¿¡æ¯ï¼Œå…è®¸ç½‘ç»œè‡ªæˆ‘å‘å±•å¹¶å†³å®šå¦‚ä½•ä½¿ç”¨å…¶èµ„æºæ¥æœ€å¥½åœ°å®Œæˆä»»åŠ¡ã€‚*

# *ä¸ LSTM å…±å»º RNN*

*![](img/45f6ef0764a6fb73f66dc471e3323304.png)*

*Photo by [M. B. M.](https://unsplash.com/@m_b_m?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)*

*ä¸ºäº†æµ‹è¯•è¿™ä¸€ç‚¹ï¼Œæˆ‘å†³å®šä½¿ç”¨ LSTMs å¤åˆ¶ä¸€ä¸ª RNN æ¥é¢„æµ‹è°·æ­Œè‚¡ç¥¨ä»·æ ¼çš„ä¸Šæ¶¨å’Œä¸‹è·Œè¶‹åŠ¿ã€‚*

*è¿™ä¸ªæ¨¡å‹ä½¿ç”¨ 2009 å¹´è‡³ 2017 å¹´çš„æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œç„¶åé¢„æµ‹ 2018 å¹´çš„è¶‹åŠ¿(ç„¶åä¸å®é™…è¶‹åŠ¿è¿›è¡Œæ¯”è¾ƒ)ã€‚ä½ å¯ä»¥åœ¨æˆ‘çš„ GitHub é¡µé¢ä¸Šçœ‹åˆ°æˆ‘æ‰€æœ‰çš„ä»£ç ã€‚*

*è¿™ä¸ªè¿‡ç¨‹å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ­¥éª¤:
1 .æ•°æ®é¢„å¤„ç†
2ã€‚å»ºç«‹ RNN(ä¸€ä¸ªè¾å­¦æ­£è§„åŒ–çš„å †å  LSTM)
3ã€‚åšå‡ºé¢„æµ‹å¹¶å¯è§†åŒ–ç»“æœ*

*æˆ‘ä»¬å¼€å§‹å§ï¼*

# *æ•°æ®é¢„å¤„ç†*

*æˆ‘ä»¬ä»å¯¼å…¥åº“å¼€å§‹:Numpy å…è®¸æˆ‘ä»¬åˆ¶ä½œæ•°ç»„ï¼ŒMatplot lib å…è®¸æˆ‘ä»¬ä½¿ç”¨å›¾è¡¨å¯è§†åŒ–ç»“æœï¼ŒPandas å…è®¸æˆ‘ä»¬è½»æ¾åœ°å¯¼å…¥å’Œç®¡ç†æ•°æ®é›†ã€‚*

```
*# Importing the libraries
import numpy as np #allow to make arrays
import matplotlib.pyplot as plt #visualize results on charts 
import pandas as pd #import dataset and manage easily*
```

*ç„¶åæˆ‘ä»¬å¯¼å…¥è®­ç»ƒé›†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨åªå¯¼å…¥è®­ç»ƒé›†(ä¸æ˜¯æµ‹è¯•é›†)ï¼Œå› ä¸ºé™¤äº†æ¯”è¾ƒæœ€ç»ˆé¢„æµ‹ä¹‹å¤–ï¼ŒRNN å®é™…ä¸Šä»ä¸ä½¿ç”¨æµ‹è¯•é›†ã€‚*

*æ•°æ®é›†ä¸­çš„åˆ—è¢«è½¬æ¢æˆ NumPy æ•°ç»„(ä½¿ç”¨â€œ.å€¼â€)ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥ç”¨ä½œ Keras ä¸­çš„è¾“å…¥å€¼*

```
*dataset_train = pd.read_csv('GOOGL_Stock_Price_Train.csv')training_set = dataset_train.iloc[:, 1:2].values*
```

*æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿›è¡Œç‰¹å¾ç¼©æ”¾ã€‚è¿™å¯ä»¥é€šè¿‡æ ‡å‡†åŒ–æˆ–è§„èŒƒåŒ–æ¥å®ç°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨è§„èŒƒåŒ–å°†å€¼è°ƒæ•´åˆ° 0 å’Œ 1 ä¹‹é—´ã€‚*

```
*from sklearn.preprocessing import MinMaxScaler
sc = MinMaxScaler(feature_range = (0, 1))
training_set_scaled = sc.fit_transform(training_set) #fit (gets min and max on data to apply formula) tranform(compute scale stock prices to each formula)*
```

*æˆ‘ä»¬ä¸ºæ¯ä¸ªè¾“å‡ºåˆ›å»ºä¸€ä¸ª 60 æ—¶é—´æ­¥é•¿çš„æ•°æ®ç»“æ„ã€‚åœ¨æ¯ä¸ªæ—¶é—´(t ),ç½‘ç»œå°†æŸ¥çœ‹ 60 ä¸ªå…ˆå‰çš„æ—¶é—´æ­¥é•¿ï¼Œä»¥åšå‡ºæ–°çš„é¢„æµ‹ã€‚æ•°å­— 60 æ˜¯åŸºäºå®éªŒçš„å€¼â€”â€”åªæœ‰ 1 ä¸ªæ—¶é—´æ­¥é•¿ï¼Œä¼šå¯¼è‡´è¿‡åº¦æ‹Ÿåˆï¼Œå³ä½¿ 20 ä¸ªæ—¶é—´æ­¥é•¿ä¹Ÿä»ç„¶å¤ªä½ã€‚60 ä¸ªæ—¶é—´æ­¥é•¿å°†æ˜¯ 3 ä¸ªæœˆçš„è´¢åŠ¡å¤©æ•°ã€‚*

```
*X_train = []
y_train = []
for i in range(60, 2168): # upper bound is number of values 
  X_train.append(training_set_scaled[i-60:i, 0]) #takes 60 previous stock prices from 60 past stock prices
  y_train.append(training_set_scaled[i, 0]) #contains stock price learned to predict 
X_train, y_train = np.array(X_train), np.array(y_train) # make into numpy arrays* 
```

*æˆ‘ä»¬è¿˜å¿…é¡»è°ƒæ•´æ•°ç»„çš„å½¢çŠ¶ä»¥å¢åŠ ç»´åº¦-æ–°ç»´åº¦å°†å…è®¸æ›´å¤šçš„æŒ‡æ ‡ï¼Œå¹¶ä¸ RNN çš„è¾“å…¥å½¢çŠ¶å…¼å®¹ï¼Œè€Œä¸æ˜¯åªæœ‰ä¸€ä¸ªæŒ‡æ ‡ã€‚*

```
*# Reshaping- add dimension in numpy array 
X_train = np.reshape(X_train, (X_train.shape[0], X_train.shape[1], 1)) #adds dimension in numpy array*
```

# *ç¬¬ 2 éƒ¨åˆ†â€”å»ºè®¾ RNN*

*(ä¸€ä¸ªå åŠ çš„ LSTMï¼Œå…·æœ‰é˜²æ­¢è¿‡åº¦æ‹Ÿåˆçš„å»é™¤è§„åˆ™)*

*æˆ‘ä»¬ä»å¯¼å…¥å¿…è¦çš„ Keras åº“/åŒ…å¼€å§‹*

```
*from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from keras.layers import Dropout*
```

*æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆå§‹åŒ– RNNã€‚è¿™è¡¨ç¤ºé¢„æµ‹è¿ç»­å€¼(å›å½’)çš„å±‚åºåˆ—*

```
*# Initialising the RNN
regressor = Sequential()* 
```

*æˆ‘ä»¬æ·»åŠ äº†ç¬¬ä¸€ä¸ª LSTM å±‚ï¼Œå¹¶åšäº†ä¸€äº›è°ƒæ•´ä»¥é˜²æ­¢è¿‡åº¦æ‹Ÿåˆã€‚*

```
*regressor.add(LSTM(units = 50, return_sequences = True, input_shape = (X_train.shape[1], 1)))
#regressor- object of sequential class, can add layers to network#use lstm class and create object of lstm class- 3 args#num of units, return sequences- set to true because is stacked lstms, and shape#units- neurons in first layer. 50 in layers for high dimensionality, can capture upward and downwardregressor.add(Dropout(0.2))# takes arg of dropout late- num of neurons want to drop. dropping 20% of neurons to be ignored during training for each iteratin. 10 neurons will be dropped out*
```

*æˆ‘ä»¬ç»§ç»­æ·»åŠ ç¬¬äºŒå±‚ã€‚æ€»å…±æœ‰ 4 ä¸ªæˆ–å¤šæˆ–å°‘ç›¸åŒçš„å›¾å±‚ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯åªéœ€è¦åœ¨ç¬¬ä¸€ä¸ª(è¾“å…¥)å›¾å±‚ä¸­æŒ‡å®šè¾“å…¥å½¢çŠ¶*

```
*regressor.add(LSTM(units = 50, return_sequences = True))regressor.add(Dropout(0.2))# Adding a third LSTM layer and some Dropout regularisation
# same as second layer 
regressor.add(LSTM(units = 50, return_sequences = True))
regressor.add(Dropout(0.2))# Adding a fourth LSTM layer and some Dropout regularisation
# almost same, but return sequence is false because it is the last lstm layer (so it is removed becasue default is false)
regressor.add(LSTM(units = 50))
regressor.add(Dropout(0.2))*
```

*æœ€åï¼Œæ·»åŠ è¾“å‡ºå±‚ã€‚è¿™ä¸€å±‚é€šè¿‡å¯†çº§å®Œå…¨è¿æ¥ã€‚*

```
*dimesion/units/neurons is 1
regressor.add(Dense(units = 1))*
```

*ç”±äºé¢„æµ‹çš„æ˜¯è¿ç»­å€¼ï¼Œå› æ­¤ä½¿ç”¨å›å½’é‡ç±»æ¥ç¼–è¯‘ RNNã€‚*

```
*regressor.compile(optimizer = 'adam', loss = 'mean_squared_error')*
```

*RNN é€‚åˆè¿™ä¸ªè®­ç»ƒé›†ã€‚è¿™æ˜¯æœ‰è¶£çš„éƒ¨åˆ†ï¼(å¼€ä¸ªç©ç¬‘ï¼Œä½ è¦ç­‰â€¦â€¦ç­‰â€¦â€¦ç­‰ç€ç»å†æ‰€æœ‰çš„æ—¶ä»£)ã€‚åŸºäºæˆ‘ä»¬æ‰€æ‹¥æœ‰çš„æ•°æ®ï¼Œ100 ä¸ªæ—¶æœŸç»™å‡ºäº†è‰¯å¥½çš„æ”¶æ•›æ€§å’Œæœ€ä½³ç»“æœã€‚*

```
*# Fitting the RNN to the Training set
#have not made connection to training set, training will take place
regressor.fit(X_train, y_train, epochs = 100, batch_size = 32)* 
```

*å¿«åˆ°äº†ï¼ï¼ï¼æˆ‘ä»¬çš„ RNN åŸºæœ¬ä¸Šå·²ç»å­¦ä¼šäº†å®ƒéœ€è¦çš„ä¸€åˆ‡ï¼Œç°åœ¨å‰©ä¸‹çš„å°±æ˜¯çœ‹åˆ°å®ƒçš„å·¥ä½œã€‚*

# *ç¬¬ 3 éƒ¨åˆ†-è¿›è¡Œé¢„æµ‹å¹¶å¯è§†åŒ–ç»“æœ*

*æµ‹è¯•é›†æœ€ç»ˆå¼€å§‹ä½¿ç”¨ï¼Œä»¥è·å¾— 2018 å¹´çš„çœŸå®è‚¡ç¥¨è¶‹åŠ¿*

```
*dataset_test = pd.read_csv('GOOGL_Stock_Price_Test.csv')
real_stock_price = dataset_test.iloc[:, 1:2].values*
```

*è¿™å°±æ˜¯æ‰€æœ‰çš„ä¸€åˆ‡ã€‚æˆ‘ä»¬çš„æ¨¡å‹è‡ªè¡Œé¢„æµ‹äº† 2018 å¹´è‚¡ä»·çš„è¶‹åŠ¿ã€‚*

```
*dataset_total = pd.concat((dataset_train['Open'], dataset_test['Open']), axis = 0)
inputs = dataset_total[len(dataset_total) - len(dataset_test) - 60:].values #getting input of each previous financial days
inputs = inputs.reshape(-1,1)
inputs = sc.transform(inputs)
X_test = []
for i in range(60, 227):
    X_test.append(inputs[i-60:i, 0])
X_test = np.array(X_test)
X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))
predicted_stock_price = regressor.predict(X_test)
predicted_stock_price = sc.inverse_transform(predicted_stock_price)*
```

*è¿˜æœ‰**å…³é”®æ—¶åˆ»**ï¼æˆ‘ä»¬é€šè¿‡å›¾è¡¨å°†æ¨¡å‹çš„ç»“æœå¯è§†åŒ–ï¼Œç”¨çº¢è‰²æ ‡æ³¨çœŸå®ä»·æ ¼ï¼Œç”¨è“è‰²æ ‡æ³¨é¢„æµ‹ä»·æ ¼ã€‚*

```
*# Visualising the results
plt.plot(real_stock_price, color = 'red', label = 'Real Google Stock Price')
plt.plot(predicted_stock_price, color = 'blue', label = 'Predicted Google Stock Price')
plt.title('Google Stock Price Prediction')
plt.xlabel('Time')
plt.ylabel('Google Stock Price')
plt.legend()
plt.show()*
```

*![](img/b2a5ef822952b6df7b039528a5f3e98a.png)*

# *è¿™ä¸€åˆ‡æ„å‘³ç€ä»€ä¹ˆï¼Ÿ*

*è¿™å…¶å®å¾ˆç–¯ç‹‚ï¼RNN èƒ½å¤Ÿéå¸¸æˆåŠŸåœ°*é¢„æµ‹ 2018 å¹´è°·æ­Œè‚¡ä»·çš„è¶‹åŠ¿ï¼Œå¦‚æœæˆ‘è¿™ä¹ˆè¯´çš„è¯*ã€‚*

*è¿™æ„å‘³ç€ï¼Œæœ‰äº†å‰å‡ å¹´çš„æ•°æ®ï¼Œ**ä»»ä½•äººéƒ½å¯ä»¥é¢„æµ‹ä»»ä½•è‚¡ç¥¨çš„è½¨è¿¹**åˆ°æ¯”*ä»¥å‰*é«˜å¾—å¤šçš„å®¹é‡ï¼*

*æ·±åº¦å­¦ä¹ æ­£åœ¨å¹¶å°†ç»§ç»­æ‰°ä¹±è‚¡ç¥¨å¸‚åœºå’ŒæŠ•èµ„è¡Œä¸šã€‚åƒè´è±å¾·ã€ä¸¤ä¸ªé€‚é©¬ã€å¤å…´ç§‘æŠ€è¿™æ ·çš„ä¸»è¦äº¤æ˜“å…¬å¸å·²ç»åœ¨ä½¿ç”¨äººå·¥æ™ºèƒ½æ¥ç®¡ç†ã€é€‰æ‹©å’Œå†³ç­–â€”â€”ä½†ç°åœ¨ä»»ä½•äººéƒ½å¯ä»¥å¤åˆ¶åŸºæœ¬æ¨¡å‹ã€‚*

*æ­£å¦‚ [Shagufta Tahsildar](https://www.quora.com/profile/Shagufta-Tahsildar-1) æ‰€è¯´ï¼Œâ€œäººå·¥æ™ºèƒ½å°†èƒ½å¤Ÿé€šè¿‡è€ƒè™‘æ‰€æœ‰æŠ€æœ¯ã€åŸºæœ¬é¢å’Œå¤–éƒ¨å› ç´ æ¥è¿›è¡Œè¯„ä¼°å¹¶é¢„æµ‹æ­£ç¡®çš„ä¼°å€¼ã€‚æ‰€æœ‰è¿™ä¸€åˆ‡éƒ½å°†åœ¨ç¬é—´å‘ç”Ÿã€‚â€*

**æ„Ÿè°¢æ‚¨çš„é˜…è¯»ï¼å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œè¯·ç•™ä¸‹ä¸€äº›æŒå£°ï¼Œå¹¶å…³æ³¨æˆ‘çš„åª’ä½“å’Œ LinkedInã€‚**