# ä½¿ç”¨æ·±åº¦å­¦ä¹ å’Œå¿«é€Ÿäººå·¥æ™ºèƒ½çš„è‡ªç„¶è¯­è¨€å¤„ç†æ¥è¯†åˆ«ä¸ç¾éš¾ç›¸å…³çš„æ¨æ–‡

> åŸæ–‡ï¼š<https://medium.datadriveninvestor.com/identifying-disaster-related-tweets-using-deep-learning-and-natural-language-processing-with-fast-e0dfb790b57a?source=collection_archive---------1----------------------->

![](img/e4e4dd061fdb7d267a2e720afd194a7c.png)

æˆ‘ä»åœ¨å­¦ä¹ å¿«é€Ÿäººå·¥æ™ºèƒ½è¯¾ç¨‹ï¼Œæ— æ³•åœæ­¢æ€è€ƒå¦‚ä½•è½»æ¾åœ°ç”¨å‡ è¡Œä»£ç åˆ›å»ºä¸€ä¸ªæœ‰æ•ˆçš„æ·±åº¦å­¦ä¹ æ¨¡å‹ã€‚æˆ‘ä¸€ç›´åœ¨å­¦ä¹  Fast Ai åº“çš„æ–‡æœ¬æ¨¡å—ï¼Œå®ƒåŒ…å«äº†åˆ›å»ºæ–¹ä¾¿çš„æ•°æ®é›†å’Œä¸åŒè‡ªç„¶è¯­è¨€å¤„ç†(NLP)ä»»åŠ¡çš„æ¨¡å‹æ‰€éœ€çš„æ‰€æœ‰åŠŸèƒ½ã€‚

NLP ä¸€ç›´æ˜¯æˆ‘å…³æ³¨çš„é¢†åŸŸã€‚NLP ä¸­æœ€å—æ¬¢è¿çš„ç”¨ä¾‹ä¹‹ä¸€æ˜¯è¯†åˆ«ç”µå½±è¯„è®ºæ˜¯æ­£é¢è¿˜æ˜¯è´Ÿé¢ï¼Œè¿™ä¸ªé—®é¢˜è¢«ç§°ä¸º**æƒ…æ„Ÿåˆ†æ**ã€‚

æ‰€ä»¥ï¼Œæˆ‘æƒ³ç”¨è¿™ä¸ªå·¥å…·å¯ä»¥åšäº›ä»€ä¹ˆï¼Œä¸ºç¤¾ä¼šå…¬ç›Šäº‹ä¸šåšå‡ºè´¡çŒ®ã€‚æˆ‘æƒ³åˆ°çš„ç¬¬ä¸€ä»¶äº‹æ˜¯åˆ†ææ¨æ–‡ï¼Œç‰¹åˆ«æ˜¯ä¸ç¾éš¾ç›¸å…³çš„ä¸œè¥¿ã€‚

[](https://www.datadriveninvestor.com/2019/02/07/8-skills-you-need-to-become-a-data-scientist/) [## æˆä¸ºæ•°æ®ç§‘å­¦å®¶æ‰€éœ€çš„ 8 é¡¹æŠ€èƒ½â€”â€”æ•°æ®é©±åŠ¨å‹æŠ•èµ„è€…

### æ•°å­—å“ä¸å€’ä½ ï¼Ÿæ²¡æœ‰ä»€ä¹ˆæ¯”ä¸€å¼ æ¼‚äº®çš„ excel è¡¨æ›´ä»¤äººæ»¡æ„çš„äº†ï¼Ÿä½ ä¼šè¯´å‡ ç§è¯­è¨€â€¦

www.datadriveninvestor.com](https://www.datadriveninvestor.com/2019/02/07/8-skills-you-need-to-become-a-data-scientist/) 

æˆ‘å°†åˆ›å»ºä¸€ä¸ªæƒ…ç»ªåˆ†ææ¨¡å‹ï¼Œä½†å®ƒä¸ä¼šåœ¨ç§¯æå’Œä¸­ç«‹ä¹‹é—´è¿›è¡Œåˆ†ç±»ï¼Œè€Œæ˜¯å°†æ¨æ–‡åˆ†ç±»ï¼Œå¹¶åˆ¤æ–­å®ƒä»¬æ˜¯å¦ä¸ç¾éš¾ç›¸å…³ã€‚è¿™å¯èƒ½æ˜¯æ”¹è¿›ç¾éš¾å“åº”çš„ä¸€ä¸ªå¾ˆå¥½çš„ç­–ç•¥ï¼Œå¹¶ä¿ç•™è¿™äº›ä¿¡æ¯ä»¥æå–ä¼˜å…ˆçš„ä½ç½®å’Œäº‹ä»¶ï¼Œå¹¶ä¸ºå®ƒä»¬èŠ‚çœæ—¶é—´å’Œèµ„æºã€‚

ä¸‹å›¾æ˜¾ç¤ºäº†æƒ…ç»ªåˆ†ææ¨¡å‹çš„å·¥ä½œåŸç†:

![](img/0cc747397522b176ece0656bbf0df08f.png)

å¯¹äºè¿™ä¸ªé¡¹ç›®ï¼Œæˆ‘å°†é‡ç‚¹å…³æ³¨çš„ä¸»è¦æ­¥éª¤æ˜¯:

1.  ä¸‹è½½å¹¶æ¢ç´¢**â€œç¤¾äº¤åª’ä½“ä¸Šçš„ç¾éš¾â€**æ•°æ®é›†
2.  ä¸ºå»ºæ¨¡å‡†å¤‡å¥½æ•°æ®
3.  å¾®è°ƒè¯­è¨€æ¨¡å‹
4.  æ„å»ºåˆ†ç±»å™¨æ¥æ£€æµ‹æ¨æ–‡ä¸­æ˜¯å¦æœ‰ç¾éš¾è¯é¢˜

æˆ‘ä¿®æ”¹äº†æ•°æ®é›†ï¼Œåªä¿ç•™äº†ä¸¤åˆ—ç”¨äºå®éªŒ:æƒ…ç»ª**å’Œæ–‡æœ¬**ã€‚****

**é¦–å…ˆï¼Œè®©æˆ‘ä»¬å¯¼å…¥è¿™ä¸ªå®éªŒæ‰€éœ€çš„å¿«é€Ÿ ai æ¨¡å—:**

```
from fastai.text import
```

**ç°åœ¨ï¼Œæˆ‘å°†å®šä¹‰æ•°æ®é›†æ‰€åœ¨çš„è·¯å¾„:**

```
path = '/content/'
path
```

# **æ¢ç´¢â€œç¤¾äº¤åª’ä½“ä¸Šçš„ç¾éš¾â€æ•°æ®é›†**

**è®©æˆ‘ä»¬æ£€æŸ¥æ•°æ®é›†çš„å‰å‡ è¡Œï¼Œçœ‹çœ‹æˆ‘ä»¬å°†ä½¿ç”¨ä»€ä¹ˆ:**

```
df = pd.read_csv(path + 'disaster_tweets.csv')
df.head()
```

**![](img/4b10f17ce83d38b6718d54d0d861e16a.png)**

```
df.info()
```

**![](img/7250ac556ad40c17debab682e419b656.png)**

**æ­£å¦‚æ‚¨æ‰€çœ‹åˆ°çš„ï¼Œå®ƒåŒ…å«ä¸¤åˆ—ï¼Œ**â€œç›®æ ‡â€**ï¼Œè¿™æ˜¯æƒ…ç»ªå’Œ**â€œæ–‡æœ¬â€**ï¼Œæ¨æ–‡æœ¬èº«ã€‚**

```
df[â€˜targetâ€™].value_counts()
```

**è¯¥æ•°æ®é›†å…±æœ‰ 18860 æ¡æ¨æ–‡ï¼Œ6187 æ¡ä¸ç¾éš¾ç›¸å…³ï¼Œ4673 æ¡ä¸ç›¸å…³ã€‚**

**![](img/aa96c3f5e63055b28ba4dded517973b0.png)**

```
df['target'].value_counts().plot(kind='bar')
```

**![](img/45100b5b22364545a834300303b80923.png)**

****â€œ0â€**è¡¨ç¤ºå¸¸è§„æ¨æ–‡ï¼Œ**â€œ1â€**è¡¨ç¤ºç¾å®³ç›¸å…³æ¨æ–‡ã€‚å¸¸è§„ä¸€ç­å¤šäº†å‡ æ¡æ¨æ–‡ã€‚**

**è®©æˆ‘ä»¬å…ˆç¹ä¸ºå¿«ï¼Œçœ‹çœ‹ä¸ç¾éš¾ç›¸å…³çš„æ¨æ–‡:**

```
df[df['target']== 1][['text','target']]
```

**![](img/657f43f7eb7dc6b9d2d8824eb5094f84.png)**

**ç°åœ¨ï¼Œå¸¸è§„çš„:**

```
df[df['target']== 0][['text','target']]
```

**![](img/a0da1ab1acb49be71b687215a098ed29.png)**

# **ä¸ºå»ºæ¨¡å‡†å¤‡å¥½æ•°æ®**

**éœ€è¦å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œä»¥ä¾¿æä¾›ç»™ NLP æ¨¡å‹ã€‚åœ¨è®¡ç®—æœºè§†è§‰æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›å›¾åƒè½¬æ¢æˆç®€å•çš„æ•°å­—é˜µåˆ—ã€‚å¤„ç†æ–‡æœ¬æ•°æ®ä¸æ­¤ç•¥æœ‰ä¸åŒã€‚è¿™ä¸ªè¿‡ç¨‹ä»æˆ‘ä»¬å°†åŸå§‹æ–‡æœ¬è½¬æ¢ä¸ºä¸€ç³»åˆ—å•è¯æˆ–æ ‡è®°å¼€å§‹ï¼Œè¿™è¢«ç§°ä¸º**â€œæ ‡è®°åŒ–â€**ï¼Œæœ€åï¼Œå°†è¿™äº›æ ‡è®°è½¬æ¢ä¸ºæ•°å­—ï¼Œè¿™æ˜¯ä¸€ä¸ªè¢«ç§°ä¸º**â€œæ•°å­—åŒ–â€**çš„è¿‡ç¨‹ã€‚è¿™äº›æ•°å­—è¢«ä¼ é€’ç»™åµŒå…¥å±‚ï¼ŒåµŒå…¥å±‚åœ¨å°†å®ƒä»¬è¾“å…¥æ¨¡å‹ä¹‹å‰å°†å®ƒä»¬è½¬æ¢æˆæµ®ç‚¹æ•°ç»„ã€‚**

**![](img/d523aca797dfd220eea5c344776eca13.png)**

**image processing for computer vision models**

**![](img/b5ba8dc080e2b4cdfea4f568855ee4bb.png)**

**Text processing (Tokenization)**

## **TextLMDataBunch å’Œ TextClassDataBunch**

**æˆ‘éœ€è¦ä¸¤ä¸ªæ¥è‡ª _csv çš„**æ–¹æ³•ï¼ŒåŸå› å¦‚ä¸‹:ä¸ºè¯­è¨€æ¨¡å‹ **(TextLMDataBunch)** å‡†å¤‡å¥½æ•°æ®ï¼Œä¸ºæ–‡æœ¬åˆ†ç±»å™¨ **(TextClassDataBunch)** å‡†å¤‡å¥½æ•°æ®ã€‚****

**ä¸‹é¢å‡ è¡Œå®Œæˆäº†é¢„å¤„ç†æ•°æ®çš„æ‰€æœ‰å¿…è¦å·¥ä½œã€‚å¯¹äºåˆ†ç±»å™¨ï¼Œæˆ‘ä¹Ÿä¼ é€’äº†æˆ‘æƒ³è¦ä½¿ç”¨çš„è¯æ±‡ã€‚åœ¨è¯æ±‡è¡¨ä¸­ï¼Œæˆ‘ç»™å•è¯åˆ†é… idã€‚å› æ­¤ **data_class** å°†ä½¿ç”¨ä¸ **data_lm** ç›¸åŒçš„å­—å…¸ã€‚**

```
# Language model data
data_lm = TextLMDataBunch.from_csv(path, 'disaster_tweets.csv')
# Classifier model data
data_clas = TextClasDataBunch.from_csv(path, 'disaster_tweets.csv', vocab=data_lm.train_ds.vocab, bs=32)
```

**è®©æˆ‘ä»¬ä¿å­˜ç»“æœï¼Œä»¥ä¾¿åœ¨æ¥ä¸‹æ¥çš„å‡ è¡Œä¸­ä½¿ç”¨:**

```
data_lm.save('data_lm_export.pkl')
data_clas.save('data_clas_export.pkl')
```

**ç°åœ¨ï¼Œæˆ‘å¯ä»¥é‡æ–°åŠ è½½è¿™äº›ç»“æœ:**

```
data_lm = load_data(path, 'data_lm_export.pkl')
data_clas = load_data(path, 'data_clas_export.pkl', bs=16)
```

# **å¾®è°ƒè¯­è¨€æ¨¡å‹**

**æˆ‘ä»¬å¯¹è®¡ç®—æœºè§†è§‰ä»»åŠ¡ä½¿ç”¨é¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œå› ä¸ºå®ƒä»¬æ˜¯åœ¨å¤§å›¾åƒæ•°æ®é›†ä¸Šè®­ç»ƒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®ƒä»¬ç”¨äºæ–°çš„ä»»åŠ¡ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦åˆ†ç±»çš„å›¾åƒç±»å‹ã€‚ä¾‹å­: **ResNetï¼ŒDenseNet VGG16** ç­‰ã€‚è¿™å°±å«**â€œè¿ç§»å­¦ä¹ â€**ã€‚**

**æ–‡æœ¬æ¨¡å‹åœ¨å°è¯•å¯¹æ–‡æœ¬è¿›è¡Œåˆ†ç±»æ—¶ä¼šé‡åˆ°å›°éš¾ã€‚æˆ‘ä»¬èƒ½æŠŠè¿ç§»å­¦ä¹ ç”¨äº NLP ä»»åŠ¡å—ï¼Ÿæ˜¯çš„ï¼Œæˆ‘ä»¬å¯ä»¥ã€‚Jeremy å’Œä»–æ¥è‡ª Fast Ai çš„æœ‹å‹ Stephen Merity å®£å¸ƒå¼€å‘äº† **AWS LSTM** è¯­è¨€æ¨¡å‹ï¼Œè¿™æ˜¯å¯¹ä»¥å‰çš„ ***è¯­è¨€å»ºæ¨¡æ–¹æ³•çš„å·¨å¤§æ”¹è¿›ã€‚*****

**è¯­è¨€æ¨¡å‹æ˜¯å­¦ä¹ é¢„æµ‹å¥å­ä¸­ä¸‹ä¸€ä¸ªå•è¯çš„ NLP æ¨¡å‹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ çš„æ‰‹æœºé”®ç›˜çŒœæµ‹ä½ ä¸‹ä¸€æ­¥æƒ³è¾“å…¥ä»€ä¹ˆå•è¯ï¼Œé‚£ä¹ˆå®ƒä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè¯­è¨€æ¨¡å‹ã€‚è¿™å¾ˆé‡è¦çš„åŸå› æ˜¯ï¼Œå¯¹äºä¸€ä¸ªçœŸæ­£æ“…é•¿çŒœæµ‹ä½ æ¥ä¸‹æ¥ä¼šè¯´ä»€ä¹ˆçš„è¯­è¨€æ¨¡å‹æ¥è¯´ï¼Œå®ƒéœ€è¦å¤§é‡çš„æ•°æ®ã€‚**

****ä¾‹å¦‚:****

****â€œæˆ‘åƒäº†ä¸€ä¸ªè¾£â€â†’â€œç‹—â€ï¼Œâ€œå¤©å¾ˆçƒ­â€â†’â€œå¤©æ°”â€)****

**![](img/e0ef05dff8318ce7494d9e904eea7b74.png)**

**High-level ULMFiT approach (IMDb example)**

**æˆ‘å°†ä½¿ç”¨è¿™ä¸ªé¢„è®­ç»ƒçš„æ¨¡å‹ï¼Œå¹¶å¯¹æˆ‘çš„åˆ†ç±»æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œè¿™ä¸ªå¿«é€Ÿçš„äººå·¥æ™ºèƒ½æœ‰ä¸€ä¸ªè‹±è¯­æ¨¡å‹ï¼Œå…·æœ‰æˆ‘ä»¬å°†åœ¨æœ¬ä¾‹ä¸­ä½¿ç”¨çš„ AWD-LSTM ä½“ç³»ç»“æ„ã€‚**

**æˆ‘å°†åˆ›å»ºä¸€ä¸ªå­¦ä¹ è€…å¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†ç›´æ¥åˆ›å»ºä¸€ä¸ªæ¨¡å‹ï¼Œä¸‹è½½é¢„å…ˆè®­ç»ƒå¥½çš„æƒé‡ï¼Œå¹¶å‡†å¤‡å¥½è¿›è¡Œå¾®è°ƒ:**

```
learn = language_model_learner(data_lm, AWD_LSTM, drop_mult=0.5)
learn.fit_one_cycle(1, 1e-2)
```

**![](img/5c736a91ef844813f357f969db72effc.png)**

**ç°åœ¨ï¼Œæ˜¯æ—¶å€™åšä¸€äº›é¢„æµ‹äº†:**

```
learn.predict("there is", n_words=10)
```

**![](img/8e5807dd620214018624db18a1c3d93e.png)**

**å…³äºé¢„æµ‹ä¸‹ä¸€ä¸ªå•è¯çš„ç¬¬ä¸€ä¸ªä»»åŠ¡æˆåŠŸäº†ï¼**

**ç°åœ¨ï¼Œè®©æˆ‘ä»¬ä¿å­˜è¿™ä¸ªç¼–ç å™¨ï¼Œä»¥ä¾¿èƒ½å¤Ÿå°†å…¶ç”¨äºåˆ†ç±»æ¨¡å‹:**

```
learn.save_encoder('ft_enc')
```

# **æ„å»ºåˆ†ç±»å™¨æ£€æµ‹æ¨æ–‡ä¸­çš„ç¾å®³è¯é¢˜**

**æˆ‘å°†ä½¿ç”¨å‰é¢åˆ›å»ºçš„ data_class å¯¹è±¡æ¥æ„å»ºå¸¦æœ‰å¾®è°ƒç¼–ç å™¨çš„åˆ†ç±»æ¨¡å‹ã€‚å¯ä»¥ä½¿ç”¨ä¸‹ä¸€è¡Œåˆ›å»ºå­¦ä¹ è€…å¯¹è±¡:**

```
learn = text_classifier_learner(data_clas, AWD_LSTM, drop_mult=0.5)
learn.load_encoder('ft_enc')
```

**è®©æˆ‘ä»¬æ¥çœ‹ä¸€å°æ‰¹æ•°æ®é›†:**

```
data_clas.show_batch()
```

**![](img/a235603e480063bc0d9a813eaab862c3.png)**

**è¯¥è®­ç»ƒæ¨¡å‹äº†ï¼**

```
learn.fit_one_cycle(1, 1e-2)
```

**![](img/8b21ca8f4419205a3846858f17be1ec5.png)**

**æˆ‘å¯ä»¥è§£å†»æ¨¡å‹å¹¶å¯¹å…¶è¿›è¡Œå¾®è°ƒ:**

```
learn.freeze_to(-2)
learn.fit_one_cycle(1, slice(5e-3/2., 5e-3))
```

**![](img/3eab5703ebb63b5979a25636d3a95a71.png)**

```
learn.unfreeze()
learn.fit_one_cycle(1, slice(2e-3/100, 2e-3))
```

**![](img/73b4dcf7114ddf1450441379492d7973.png)**

**å“‡ï¼ **80%çš„å‡†ç¡®ç‡ï¼Œ**è®©æˆ‘ä»¬çœ‹çœ‹ç»“æœå§ï¼**

**ä½¿ç”¨äº†ä¸€äº›ä¸ 2017 å¹´å¢¨è¥¿å“¥åœ°éœ‡æœ‰å…³çš„æ¨æ–‡è¿›è¡Œé¢„æµ‹ï¼Œä»¥åŠä¸€äº›å¸¸è§„æ¨æ–‡:**

```
learn.predict("**Assistance from across Canada and as far away as Mexico have joined #ForestFire fighting efforts in the #Northeast Region. Mexican fire crews arrived at Sudbury July 20, and are deployed to fires around the region. #Ontario**")
```

****(èŒƒç•´ 1ï¼Œå¼ é‡(1)ï¼Œå¼ é‡([0.0767ï¼Œ0.9233])****

```
learn.predict**(â€˜Interpreters needed to support rescue efforts in MÃ©xico. #EarthquakeMexicoâ€™)**
```

****(èŒƒç•´ 1ï¼Œå¼ é‡(1)ï¼Œå¼ é‡([0.2381ï¼Œ0.7619])****

```
learn.predict**('Oaxaca, Mexico: A new 6.1-magnitude quake has shaken southern Mexico #EarthquakeMexico #Oaxaca \\ Circa \\')**
```

****(ç±»åˆ« 1ï¼Œå¼ é‡(1)ï¼Œå¼ é‡([0.3290ï¼Œ0.6710])****

```
learn.predict**(â€˜the best thing Iâ€™ve ever done, my greatest role in this life #HappyMothersDayâ€™)**
```

****(ç±»åˆ« 0ï¼Œå¼ é‡(0)ï¼Œå¼ é‡([0.9648ï¼Œ0.0352])****

```
learn.predict**('Can you please help me share this message for my mom ? Thanks a lot ğŸ™')**
```

****(ç±»åˆ« 0ï¼Œå¼ é‡(0)ï¼Œå¼ é‡([0.9165ï¼Œ0.0835])****

```
learn.predict**("I'm just trying to take care of her, do my job and be the best Jet I can be.** [**@RetireMoms**](http://twitter.com/RetireMoms) **| #HappyMothersDay")**
```

****(ç±»åˆ« 0ï¼Œå¼ é‡(0)ï¼Œå¼ é‡([0.9160ï¼Œ0.0840])****

**æˆ‘å¯¹è¿™äº›ç»“æœå¾ˆæ»¡æ„ã€‚è¯•è¯•è‡ªå·±çš„åˆ†ç±»æ¨¡å‹ï¼Œåˆ†äº«ä¸€ä¸‹ï¼**

# **å‚è€ƒ**

## **æ–‡æœ¬æ¨¡å‹ã€æ•°æ®å’ŒåŸ¹è®­**

**[](https://docs.fast.ai/text.html) [## æ–‡| fastai

### åº”ç”¨äº NLPï¼ŒåŒ…æ‹¬ ULMFiT å¾®è°ƒ

docs.fast.ai](https://docs.fast.ai/text.html) 

## ç¤¾äº¤åª’ä½“æ•°æ®é›†ä¸Šçš„ç¾éš¾

[](https://www.kaggle.com/jannesklaas/disasters-on-social-media) [## ç¤¾äº¤åª’ä½“ä¸Šçš„ç¾éš¾

### å“ªäº›æ¨æ–‡æ˜¯ç›¸å…³æ–°é—»ï¼Œå“ªäº›åªæ˜¯æˆè°‘ï¼Ÿ

www.kaggle.com](https://www.kaggle.com/jannesklaas/disasters-on-social-media) 

## ä½¿ç”¨é€šç”¨è¯­è¨€æ¨¡å‹ä»‹ç»æœ€æ–°çš„æ–‡æœ¬åˆ†ç±»æŠ€æœ¯

[](http://nlp.fast.ai/) [## fast.ai NLP å®ç”¨ NLP

### è¿ç§»å­¦ä¹ æå¤§åœ°å½±å“äº†è®¡ç®—æœºè§†è§‰ï¼Œä½†ç°æœ‰çš„æ–¹æ³•åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»ç„¶éœ€è¦ç‰¹å®šçš„ä»»åŠ¡â€¦

nlp.fast](http://nlp.fast.ai/) 

*åŸè½½äº 2019 å¹´ 5 æœˆ 15 æ—¥*[*https://www.datadriveninvestor.com*](https://www.datadriveninvestor.com/2019/05/15/identifying-disaster-related-tweets-using-nlp/)*ã€‚***